\documentclass[12pt]{jsarticle}

\usepackage{amsmath}

%\editor{tamura-kosei}

\begin{document}

\section{特異値分解(Singular Value Decomposition;SVD)}
\begin{equation}
  \label{A=USV}
  A = U \Sigma V
\end{equation}
ここで$A$を$m×n$行列で，$U$は$m×m$直交行列，$\Sigma$は$m×n$行列，$V$は$n×n$直交行列である．
$\Sigma$は対角行列であり，$d_i^*$を行列$A$の特異値とすると，
\begin{equation}
  \label{D_diag}
  D = diag(d_1^*, d_2^*, ..., d_n^*)
\end{equation}
とかける．

特異値分解の性質
\begin{itemize}
  \item $A$が与えられたとき，特異値を定める行列$Σ$は一意に決まりますが，直交行列$U$,$V$は一意に定まるとは限りません。
  \item 行列の（0 でない）特異値の数は，その行列のランクと一致します。
  \item 行列の特異値の二乗和はその行列の全成分の二乗和と等しいです。先ほどの具体例ではどちらも24になっています。この値の平方根を行列のフロベニウスノルムと言います。
  \item $A$が対称行列のとき，$A$の固有値と特異値は一致します。対称行列は直交行列で対角化できるからです。
  \item $A^TA$ の 0 でない固有値の正の平方根は$A$の特異値です。これは，$A=UΣV$のとき$A^TA=V^TΣ^TΣV$であることから分かります。同様に，$AA^T$ の 0 でない固有値の正の平方根も$A$の特異値です。
\end{itemize}

\subsection{特異値分解の例題}
\begin{equation}
  A=\left( \begin{array}{rrcr}
  -2     & 1        & 1    \\
  2      & 4        & 1    \\
  1      & 1        & -2   \\
  -2     & 1        & 1 
  \end{array} \right)
\end{equation}
\begin{equation}
  \label{}
  A^T A=\left( \begin{array}{rrcr}
  10      & -5       & -5    \\
  -5      & 7        & -2    \\
  -5      & -2       & 7     \\
  \end{array} \right)
\end{equation}
\begin{equation}
  \label{}
  \phi(\lambda) = |\lambda I - A^T A| = (\lambda - 15)(\lambda - 9)\lambda = 0
\end{equation}
したがって，$A^T A$の固有値は，$\lambda_1=15$，$\lambda_2=9$，$\lambda_3=0$ となる
よって行列$A$の特異値は，$\mu_1=\sqrt{15}$，$\mu_1=\sqrt{9}=3$となる．
\begin{equation}
  \label{}
  \Delta_2 = \left( \begin{array}{rrcr}
  \sqrt{15}      & 0    \\
  0              & 3    \\
  \end{array} \right)
\end{equation}
さらに，$A^T A V_{[2]}=V_{2}\Delta_2^2$，$U_{[2]}=A V_2 \Delta_2^{-1}$より
\begin{equation}
  \label{}
  U_{[2]} = \left( \begin{array}{rrcr}
  \sqrt{\frac{2}{5}} & 0  \\
  -\sqrt{\frac{1}{10}} & \frac{\sqrt{2}}{2} \\
  -\sqrt{\frac{1}{10}}  & -\frac{\sqrt{2}}{2} \\
  \sqrt{\frac{2}{5}}   & 0  \\
  \end{array} \right)，
  V_{[2]} = \left( \begin{array}{rrcr}
  -\frac{2}{\sqrt{6}} & 0 \\
  \frac{1}{\sqrt{6}}  & -\frac{1}{\sqrt{2}} \\
  \frac{1}{\sqrt{6}}  & \frac{1}{\sqrt{2}} \\
  \end{array} \right)
\end{equation}
となるから，$A$ の特異値分解は
\begin{equation}
  \label{}
  A = \sqrt{15} \left( \begin{array}{rrcr}
  \sqrt{\frac{2}{5}}   \\
  -\frac{1}{\sqrt{10}} \\
  -\frac{1}{\sqrt{10}} \\
  \sqrt{\frac{2}{5}}   \\
  \end{array} \right)
  \left( \begin{array}{rrcr}
  -\frac{2}{\sqrt{6}}，\frac{1}{\sqrt{6}}，\frac{1}{\sqrt{6}}
  \end{array} \right)
  +3
  \left( \begin{array}{rrcr}
  0 \\
  \frac{\sqrt{2}}{2} \\
  -\frac{\sqrt{2}}{2} \\
  0 \\
  \end{array} \right)
  \left( \begin{array}{rrcr}
  0，-\frac{1}{\sqrt{2}}，\frac{1}{\sqrt{2}}\\
  \end{array} \right)
\end{equation}
\section{一般逆行列}

定義
　$A$を$(n,m)$型行列とする線形方程式$Ax=y$が解$x$をもつような$y$に対して，$x=A^-y$がこの方程式の一つの解となる場合，$(m,n)$型行列$A^-$を$A$の一般逆行列という．
ムーアペンローズ一般逆行列(Moore and Penrose generalized inverse)の定義
\begin{enumerate}
  \item $AA^-A = A$
  \item $A^-AA^- = A^-$
  \item $(A A^-)' = AA^-$
  \item $(A^- A)' = A^-A$
\end{enumerate}
補助定理
　$(n,m)$型行列$A$の特異値分解が式(\ref{A=USV})で与えられ，$S_1$，$S_2$，$S_3$がそれぞれ任意の$(r,n-r)$，$(m-r,r)$，$(m-r,n-r)$型行列のとき，$A$の一般逆行列は次式で与えられる．
\begin{equation}
  A^-=V \left( \begin{array}{rrcr}
  \Delta_r^{-1} & S_1 \\
  S_2 & S_3\\
  \end{array} \right)
  U^T
\end{equation}
特異値に関する性質　
　特異値に関する補助定理1
\begin{equation}
  \max_x \frac{||Ax||}{||x||} = \mu_1(A)
\end{equation}
　特異値に関する補助定理2
\begin{equation}
  \max_{V_1'x=0} \frac{x'A'Ax}{x'x} = \lambda_{s+1}(A'A)
  \max_{V_1'x=0} \frac{||Ax||}{||x||} = \mu_{s+1}(A)
\end{equation}

実際の計算
\begin{equation}
  A^T A=\left( \begin{array}{rrcr}
  10      & -5       & -5    \\
  -5      & 7        & -2    \\
  -5      & -2       & 7     \\
  \end{array} \right)
\end{equation}

$A^T A$の固有値，正規化された固有ベクトルを計算する．
\begin{equation}
  \label{eigen_value}
  \lambda = 3，9
\end{equation}
はじめに $\lambda_1 = 3$のとき
\begin{equation}
  \label{eigen_vector_lambda1}
  u_1 = \left(\begin{array}{rrcr}
  \frac{1}{\sqrt{2}} \\
  \frac{1}{\sqrt{2}} \\
  \end{array} \right)
\end{equation}
次に $\lambda_2 = 9$のとき
\begin{equation}
  \label{eigen_vector_lambda2}
  u_2 = \left(\begin{array}{rrcr}
  \frac{1}{\sqrt{2}} \\
  -\frac{1}{\sqrt{2}} \\
  \end{array} \right)
\end{equation}
固有値固有ベクトルを使って，次のベクトルを計算する．
はじめに $\lambda_1 = 3$のとき
\begin{equation}
  \label{v_vector_1}
  v_1 = \left(\begin{array}{rrcr}
  -\frac{1}{\sqrt{6}} \\
  -\frac{1}{\sqrt{6}} \\
  \frac{2}{\sqrt{6}} \\
  \end{array}\right)
\end{equation}
次に $\lambda_2 = 9$のとき
\begin{equation}
  \label{v_vector_2}
  v_2 = \left(\begin{array}{rrcr}
  \frac{1}{\sqrt{2}} \\
  -\frac{1}{\sqrt{2}} \\
  0 \\
  \end{array}\right)
\end{equation}
それらの値を使って，特異値，ムーアペンローズ逆行列を計算できる．
\begin{eqnarray}
  \label{singular_value}
  A &=& \sqrt{3} v_1 u_1^T + \sqrt{9} v_2 u_2^T \\
    &=& \left(\begin{array}{rrcr}
    \frac{3}{2}  & -\frac{3}{2} \\
    -\frac{3}{2} & \frac{3}{2} \\
    0 & 0 \\
    \end{array}\right)
    +
    \left(\begin{array}{rrcr}
    -\frac{1}{2}  & -\frac{1}{2} \\
    -\frac{1}{2}  & -\frac{1}{2} \\
    1 & 1 \\
    \end{array}\right)
\end{eqnarray}
\begin{eqnarray}
  \label{inverse_vector}
  A^- &=& \frac{1}{\sqrt{3}} u_1 v_1^T + \frac{1}{\sqrt{9}} u_2 v_2^T \\
      &=& \frac{1}{3} \left(\begin{array}{rrcr}
       0 & -1 & 1 \\
      -1 &  0 & 1 \\
      \end{array}\right)
\end{eqnarray}

\begin{thebibliography}{9}
  \bibitem{koukousuugaku} 特異値分解の定義，性質，具体例, https://mathtrain.jp/svd
  \bibitem{} 一般逆行列 https://www.slideshare.net/wosugi/ss-79624897
  \bibitem{} 射影行列・一般逆行列・特異値分解 
\end{thebibliography}

\end{document}
